(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[24],{"+OFz":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.AUTO="AUTO",e.MANUAL="MANUAL"}(r||(r={}))},BTyb:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return f}));var r=n("jT3O"),i=n("UYTu");function s(){var e=Object(r.a)(["\n  mutation deletePatientAddress($id: String) {\n    deletePatientAddress(id: $id) {\n      status\n    }\n  }\n"]);return s=function(){return e},e}function a(){var e=Object(r.a)(["\n  mutation UpdatePatientAddress(\n    $UpdatePatientAddressInput: UpdatePatientAddressInput!\n  ) {\n    updatePatientAddress(\n      UpdatePatientAddressInput: $UpdatePatientAddressInput\n    ) {\n      patientAddress {\n        id\n        addressLine1\n        addressLine2\n        city\n        mobileNumber\n        state\n        zipcode\n        landmark\n        createdDate\n        updatedDate\n        addressType\n        otherAddressType\n        latitude\n        longitude\n        stateCode\n        name\n      }\n    }\n  }\n"]);return a=function(){return e},e}function o(){var e=Object(r.a)(["\n  mutation SavePatientAddress($patientAddress: PatientAddressInput) {\n    savePatientAddress(PatientAddressInput: $patientAddress) {\n      patientAddress {\n        id\n        addressLine1\n        addressLine2\n        city\n        mobileNumber\n        state\n        zipcode\n        landmark\n        createdDate\n        addressType\n        otherAddressType\n        latitude\n        longitude\n        stateCode\n        name\n      }\n    }\n  }\n"]);return o=function(){return e},e}function c(){var e=Object(r.a)(["\n  query GetPatientAddressList($patientId: String!) {\n    getPatientAddressList(patientId: $patientId) {\n      addressList {\n        id\n        addressLine1\n        addressLine2\n        city\n        mobileNumber\n        state\n        zipcode\n        landmark\n        createdDate\n        updatedDate\n        addressType\n        otherAddressType\n        latitude\n        longitude\n        stateCode\n        name\n      }\n    }\n  }\n"]);return c=function(){return e},e}var d=Object(i.a)(c()),u=Object(i.a)(o()),l=Object(i.a)(a()),f=Object(i.a)(s())},WHms:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("cpVT"),i=n("G874"),s=n("LCfo"),a=n("qXvB"),o=n("q1tI");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var d=function(){var e,t,n,d=Object(o.useContext)(i.a),u=(null===d||void 0===d||null===(e=d.circlePlanInCart)||void 0===e?void 0:e.currentSellingPrice)||(null===d||void 0===d||null===(t=d.circlePlanInCart)||void 0===t?void 0:t.price)||0,l=null===d||void 0===d||null===(n=d.circlePlans)||void 0===n?void 0:n.filter((function(e){return e.displayOnUI})),f=null===l||void 0===l?void 0:l.find((function(e){return null===e||void 0===e?void 0:e.defaultPack})),p=Object(s.Y)(l)||a.G;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({defaultCirclePlan:f,defaultCirclePlanPrice:(null===f||void 0===f?void 0:f.currentSellingPrice)||(null===f||void 0===f?void 0:f.price)||a.G,startingCirclePlanPrice:p,cartCirclePlanPrice:u},d)}},ejkf:function(e,t,n){"use strict";n.r(t),n.d(t,"LocationContext",(function(){return D})),n.d(t,"LocationProvider",(function(){return U})),n.d(t,"useLocationDetails",(function(){return k}));var r=n("vJKn"),i=n.n(r),s=n("rg98"),a=n("nKUr"),o=n("vDqi"),c=n.n(o),d=n("+OFz"),u=n("LCfo"),l=n("qXvB"),f=n("5OVL"),p=n("4bEK"),v=n("xZta"),b=n("mwIZ"),O=n.n(b),A=n("+1b/"),P=n("q1tI"),g=n.n(P),y=n("BTyb"),j=n("J2aL"),m=n("OrY9"),S=n("5ZT8"),I=n("grpG"),C=n("h3R5"),L=n("WHms"),h=n("LpXq"),D=g.a.createContext({editAddress:null,setEditAddress:function(e){},patientCurrentAddress:null,setPatientCurrentAddress:function(e){},isPincodeServiceable:!0,setIsPincodeServiceable:function(e){},isAddressListUpdated:!1,setIsAddressListUpdated:function(e){},isAddressUpdated:!1,setIsAddressUpdated:function(e){},pickAddressMobileDialogOpen:!1,setPickAddressMobileDialogOpen:function(e){},pickAddressDesktopDialogOpen:!1,setPickAddressDesktopDialogOpen:function(e){},isAddAddressCartDialogOpen:!1,setIsAddAddressCartDialogOpen:function(e){},isCartAddressLoading:!1,setIsCartAddressLoading:function(e){},currentLocation:null,paymentPage:null,currentLat:null,currentLong:null,currentPincode:null,placeId:null,city:null,state:null,country:null,area:null,cityId:null,stateId:null,isUserDeniedLocationAccess:null,showPincodeModal:!1,headerPincodeError:!1,setCurrentLocation:function(e){},setCurrentLat:function(e){},setCurrentLong:function(e){},setCurrentPincode:function(e){},locateCurrentLocation:function(){return Promise.resolve(!0)},setPlaceId:function(e){},setCity:function(e){},setState:function(e){},setCountry:function(e){},setArea:function(e){},setStateId:function(e){},setCityId:function(e){},getCurrentLocationPincode:function(e,t,n){return Promise.resolve(!0)},getPlaceDetailsPincode:function(e,t){return Promise.resolve(!0)},setIsUserDeniedLocationAccess:function(e){},setShowPincodeModal:function(e){},setHeaderPincodeError:function(e){}}),T=!1,U=function(e){var t=Object(P.useState)(!1),n=t[0],r=t[1],o=Object(P.useState)(!1),b=o[0],g=o[1],U=Object(P.useState)(null),k=U[0],E=U[1],w=Object(P.useState)((null===e||void 0===e?void 0:e.isPaymentPage)||!1),_=w[0],N=w[1],M=Object(P.useState)(""),x=M[0],G=M[1],z=Object(P.useState)(null),q=z[0],H=z[1],$=Object(P.useState)(null),F=$[0],J=$[1],V=Object(P.useState)(""),Y=V[0],B=V[1],R=Object(P.useState)(""),W=R[0],K=R[1],X=Object(P.useState)(""),Z=X[0],Q=X[1],ee=Object(P.useState)(""),te=ee[0],ne=ee[1],re=Object(P.useState)(""),ie=re[0],se=re[1],ae=Object(P.useState)(""),oe=ae[0],ce=ae[1],de=Object(P.useState)(null),ue=de[0],le=de[1],fe=Object(P.useState)(null),pe=fe[0],ve=fe[1],be=Object(P.useState)(null),Oe=be[0],Ae=be[1],Pe=Object(P.useState)(!1),ge=Pe[0],ye=Pe[1],je=Object(P.useState)(!1),me=je[0],Se=je[1],Ie=Object(P.useState)(null),Ce=Ie[0],Le=Ie[1],he=Object(P.useState)(!1),De=he[0],Te=he[1],Ue=Object(P.useState)(!1),ke=Ue[0],Ee=Ue[1],we=Object(P.useState)(!1),_e=we[0],Ne=we[1],Me=Object(P.useState)(!0),xe=Me[0],Ge=Me[1],ze=Object(P.useState)(!1),qe=ze[0],He=ze[1],$e=Object(A.useGlobalShoppingCart)(),Fe=$e.cartItems,Je=$e.cartShipments,Ve=$e.deliveryAddresses,Ye=$e.deliveryAddressId,Be=$e.pharmaAddressDetails,Re=$e.setMedicineAddress,We=$e.setPharmaAddressDetails,Ke=$e.setDeliveryAddresses,Xe=$e.setUserActionPayload,Ze=Object(L.a)(),Qe=Ze.isUserCircle,et=Ze.isCircleApplied,tt=Ze.cartCirclePlanPrice,nt=Object(m.b)(),rt=(Object(j.b)().currentPatient||{}).id,it=void 0===rt?"":rt,st=null===Be||void 0===Be?void 0:Be.pincode;Object(P.useEffect)((function(){N(null===e||void 0===e?void 0:e.isPaymentPage)}),[null===e||void 0===e?void 0:e.isPaymentPage]);var at=function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var n=Object(f.d)(),r=function(n){var r=n.latitude,i=n.longitude;H(r.toString()),J(i.toString()),Ae(!1),ct(r.toString(),i.toString(),d.a.AUTO).then((function(t){e(t)})).catch((function(e){t(e)}))},i=function(e){Ae(!0),console.error(e.message),t(!0)};n!==f.a.PHONEPE_SWITCH?n!==f.a.PAYTM_MINIAPP?navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,i=t.longitude;r({latitude:n,longitude:i})}),(function(e){i(e)}),l.l):Object(p.g)(r,i):Object(v.g)(r,i)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ot=function(e,t,n,i,s){var a,o=function(e,t){var n=e.find((function(e){return Object(u.L)(t,e.address_components||[])}));return n?Object(u.L)(t,n.address_components||[]):""}(e,"postal_code"),c=(null===(a=e[0])||void 0===a?void 0:a.address_components)||[],l=sessionStorage.getItem("serviceableCity")||"",f=i===d.a.AUTO?Object(u.L)("administrative_area_level_2",c)||Object(u.L)("locality",c):l||Object(u.L)("administrative_area_level_2",c)||Object(u.L)("locality",c),p=Object(u.L)("administrative_area_level_1",c),v=Object(u.L)("country",c);r(!1),s?Xe({zipcode:o,latitude:Number(t),longitude:Number(n)}):(H(t),J(n),B(o),Re(f),G(f),We({city:f,state:p,pincode:o,country:v,lat:t,lng:n}),localStorage.setItem("pharmaAddressDetails",JSON.stringify({city:f,state:p,pincode:o,country:v,lat:t,lng:n})),localStorage.setItem("pharmaPincode",o))},ct=function(){var e=Object(s.a)(i.a.mark((function e(t,n,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.get("".concat("https://maps.googleapis.com/maps/api/geocode/json","?latlng=").concat(t,",").concat(n,"&key=").concat("AIzaSyCu4uyf9ln--tU-8V32nnFyfk8GN4koLI0")).then((function(e){var i=e.data;try{var s;if(null===i||void 0===i||null===(s=i.results)||void 0===s?void 0:s[0]){var a=i.results;return ot(a,t,n,r,it),!0}throw Error("Google API failed to get current location details")}catch(o){}})).catch((function(e){return console.error(e,"Google API failed to get current location details"),!0}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),dt=function(){var e=Object(s.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.get("".concat("https://maps.googleapis.com/maps/api/geocode/json","?address=").concat(t,"&components=country:in&key=").concat("AIzaSyCu4uyf9ln--tU-8V32nnFyfk8GN4koLI0")).then((function(e){var t=e.data;try{var r;if(null===t||void 0===t||null===(r=t.results)||void 0===r?void 0:r[0]){var i=t.results;return ot(i,O()(t.results[0],"geometry.location.lat",""),O()(t.results[0],"geometry.location.lng",""),n,it),!0}}catch(s){}})).catch((function(e){return console.error(e,"Google API failed to fetch address details from pincode"),!0}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(P.useEffect)((function(){it&&Ne(!1)}),[it]),Object(P.useEffect)((function(){T||(null===st||void 0===st?void 0:st.length)!==u.v||Object(h.a)(st).then((function(e){var t=e.serviceable;He(t)})).catch((function(e){He(!1)})).finally((function(){T=!0}))}),[st]),Object(P.useEffect)((function(){!xe&&_e&&function(){if(it)try{Ee(!0),_e&&function(e,t){var n=(null===e||void 0===e?void 0:e.find((function(e){return e.id===t})))||null;if(n){var r,i=n.zipcode,s=void 0===i?"":i,a=n.city,o=void 0===a?"":a,c=n.state,d=void 0===c?"":c,l=n.latitude,f=void 0===l?"":l,p=n.longitude,v=void 0===p?"":p,b=(null===f||void 0===f?void 0:f.toString())||"",A=(null===v||void 0===v?void 0:v.toString())||"";We({city:o,state:d,pincode:s,country:"",lat:b,lng:A}),localStorage.setItem("pharmaPincode",s),localStorage.setItem("pharmaAddressDetails",JSON.stringify({city:o,state:d,pincode:s,country:"",lat:b,lng:A})),E(n),Object(S.c)({category:"Pharmacy",action:"Order",label:"Address Selected"}),Object(S.b)({event:"Address Selected",PINCode:n.zipcode,City:n.city});var P=Object(I.e)(Je),g=Object(u.R)();Object(C.e)("Pharmacy Address Selected Success",{"Circle membership added":Qe?"Existing":et?"Added":"Not Added","Delivery TAT":O()(P,[0,"orderTat"],""),TAT_Hrs:O()(P,[0,"hourDifference"],""),"Split cart":(null===Je||void 0===Je?void 0:Je.length)>1?"Yes":"No","Cart items":Fe,"Delivery Address":n,"User type":(null===g||void 0===g||null===(r=g.source_meta_data)||void 0===r?void 0:r.purchase_type)||"","Delivery successful":"",Pincode:(null===n||void 0===n?void 0:n.zipcode)||"","TAT Displayed":O()(P,[0,"orderTat"],""),"CT source":"Web","Circle Membership Value":tt||"",City:(null===n||void 0===n?void 0:n.city)||""})}else E(null);Ge(!0)}(Ve,Ye)}catch(e){E(null),console.error("UPDATING PATIENT ADDRESS FAILED",e)}finally{Ee(!1)}}()}),[xe,_e,Ve,Ye,it]),Object(P.useEffect)((function(){!_e&&it&&nt.query({query:y.b,variables:{patientId:it},fetchPolicy:"no-cache"}).then((function(e){var t=O()(e,["data","getPatientAddressList","addressList"],[]),n=null===t||void 0===t?void 0:t.reverse().filter((function(e){return e.id}));Ke(n)})).catch((function(e){E(null),console.error("FETCHING ADDRESS DETAILS FAILED",e)})).finally((function(){Ee(!1),Ne(!0)}))}),[_e,it]),Object(a.jsx)(D.Provider,{value:{editAddress:Ce,setEditAddress:Le,patientCurrentAddress:k,setPatientCurrentAddress:E,isPincodeServiceable:qe,setIsPincodeServiceable:He,isAddressListUpdated:_e,setIsAddressListUpdated:Ne,isAddressUpdated:xe,setIsAddressUpdated:Ge,pickAddressMobileDialogOpen:ge,setPickAddressMobileDialogOpen:ye,pickAddressDesktopDialogOpen:me,setPickAddressDesktopDialogOpen:Se,isAddAddressCartDialogOpen:De,setIsAddAddressCartDialogOpen:Te,isCartAddressLoading:ke,setIsCartAddressLoading:Ee,headerPincodeError:n,showPincodeModal:b,currentLocation:x,paymentPage:_,currentLat:q,currentLong:F,setCurrentLocation:G,setCurrentLat:H,setCurrentLong:J,currentPincode:Y,setCurrentPincode:B,locateCurrentLocation:at,getCurrentLocationPincode:ct,isUserDeniedLocationAccess:Oe,setIsUserDeniedLocationAccess:Ae,placeId:W,setPlaceId:K,city:Z,setCity:Q,area:oe,setArea:ce,country:ie,setCountry:se,state:te,setState:ne,setCityId:le,cityId:ue,stateId:pe,setStateId:ve,setShowPincodeModal:g,setHeaderPincodeError:r,getPlaceDetailsPincode:dt},children:e.children})},k=function(){return Object(P.useContext)(D)}}}]);