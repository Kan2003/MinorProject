(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{G874:function(n,e,t){"use strict";t.d(e,"a",(function(){return O})),t.d(e,"b",(function(){return I}));var r=t("nKUr"),i=t("q4oJ"),a=t("J2aL"),d=t("mwIZ"),s=t.n(d),c=t("q1tI"),u=t.n(c),o=t("OrY9"),l=t("MVfC"),p=t("aQR8"),m=t("br6S"),O=u.a.createContext({circlePlans:null,cashbacks:null,circlePlanInCart:null,setCirclePlanInCart:null,isCircleApplied:!1,setIsCircleApplied:null,isUserCircle:!1,setIsUserCircle:null,subscriptionCartDetails:null,setSubscriptionCartDetails:null,userSubscriptionsUpdated:!1,setUserSubscriptionsUpdated:null,userSubscriptions:null,setUserSubscriptions:null,fetchUpdatedSubscriptions:null,selectedPlan:null,setSelectedPlan:null,isPlanFetched:!1,packageIds:null}),I=function(n){var e=Object(a.b)().isSignedIn,t=Object(o.b)(),d=b(),u=f(),l=Object(c.useState)(!1),p=l[0],I=l[1],S=Object(c.useState)(!1),v=S[0],y=S[1],g=Object(c.useState)([]),h=g[0],M=g[1],P=Object(c.useState)(!1),C=P[0],j=P[1],$=Object(c.useState)(null),D=$[0],q=$[1],A=Object(c.useState)(null),k=A[0],T=A[1],N=Object(c.useState)(!1),R=N[0],L=N[1],_=Object(c.useState)(null),U=_[0],B=_[1],V=Object(c.useState)(null),E=V[0],F=V[1];Object(c.useEffect)((function(){B(JSON.parse(localStorage.getItem("userSubscriptions")||null))}),[R]),Object(c.useEffect)((function(){var n=!!Object.keys(U||{}).find((function(n){var e;return null===U||void 0===U||null===(e=U[n])||void 0===e?void 0:e.find((function(n){var e;return"active"===(null===n||void 0===n?void 0:n.status)&&"circle plan"===(null===n||void 0===n||null===(e=n.name)||void 0===e?void 0:e.toLowerCase())}))}));I(n)}),[U]),Object(c.useEffect)((function(){if(e===m.a.SIGNEDIN){if(!(null===k||void 0===k?void 0:k.circleAddedToCart)||k.userSubscriptionId)q(null),F(null);else if(!(null===k||void 0===k?void 0:k.userSubscriptionId)&&d){var n=d.find((function(n){return n.subPlanId===(null===k||void 0===k?void 0:k.subPlanId)}));n&&q(n)}j(!!(null===k||void 0===k?void 0:k.subscriptionApplied))}}),[k,d,e]),Object(c.useEffect)((function(){k&&d&&y(!0)}),[E,k]),Object(c.useEffect)((function(){!function(){var n,e,t,r,i=[];if((null===U||void 0===U||null===(n=U.HDFC)||void 0===n?void 0:n.length)&&"active"==(null===(e=U.HDFC[0])||void 0===e?void 0:e.status)){var a="HDFC:".concat(U.HDFC[0].plan_id);i.push(a)}if((null===U||void 0===U||null===(t=U.APOLLO)||void 0===t?void 0:t.length)&&"active"==(null===(r=U.APOLLO[0])||void 0===r?void 0:r.status)){var d="APOLLO:".concat(U.APOLLO[0].plan_id);i.push(d)}if(E){var s="APOLLO:".concat(E.subPlanId);i.push(s)}M(i)}()}),[U,E]),Object(c.useEffect)((function(){D?(F(D),localStorage.setItem("CIRCLEPlan",JSON.stringify(D))):localStorage.removeItem("CIRCLEPlan"),j(!!(null===k||void 0===k?void 0:k.subscriptionApplied))}),[D,k]);return Object(r.jsx)(O.Provider,{value:{circlePlans:d,cashbacks:u,circlePlanInCart:D,setCirclePlanInCart:q,subscriptionCartDetails:k,setSubscriptionCartDetails:T,isCircleApplied:C,setIsCircleApplied:j,isUserCircle:p,setIsUserCircle:I,userSubscriptions:U,setUserSubscriptions:B,userSubscriptionsUpdated:R,setUserSubscriptionsUpdated:L,fetchUpdatedSubscriptions:function(){var n={},r={};e===m.a.SIGNEDIN?t.query({query:i.C,variables:{mobile_number:localStorage.getItem("mobile_num"),status:["active","deferred_active","deferred_inactive","disabled"]},fetchPolicy:"no-cache"}).then((function(e){var t=s()(e,"data.GetSubscriptionsOfUserByStatus.response",null);t&&(Object.keys(t).forEach((function(e){var i;(null===(i=t[e])||void 0===i?void 0:i.length)&&t[e].map((function(t){"active"==t.status?(n[e]||(n[e]=[]),n[e].push(t)):(r[e]||(r[e]=[]),r[e].push(t))}))})),localStorage.setItem("userSubscriptions",JSON.stringify(n)),localStorage.setItem("inactiveSubscriptions",JSON.stringify(r)),L(!0),B(n))})).catch((function(n){console.error("Unable to fetch updated subscriptions :( ",n)})):L(!1)},selectedPlan:E,setSelectedPlan:F,isPlanFetched:v,packageIds:h},children:n.children})},b=function(){var n=Object(c.useState)(null),e=n[0],t=n[1],r=Object(o.b)();return Object(c.useEffect)((function(){e||r.query({query:i.r,variables:{plan_id:"CIRCLEPlan"},fetchPolicy:"cache-first"}).then((function(n){var e,r,i,a=null===n||void 0===n||null===(e=n.data)||void 0===e||null===(r=e.GetPlanDetailsByPlanId)||void 0===r||null===(i=r.response)||void 0===i?void 0:i.plan_summary;t(a||[])})).catch((function(n){console.error(n,"Failed to fetch circle plan details")}))}),[e]),e},f=function(){var n=Object(c.useState)(null),e=n[0],t=n[1],r=Object(o.b)();return Object(c.useEffect)((function(){e||r.query({query:l.c,fetchPolicy:"no-cache",variables:{plan_id:p.F.CIRCLEPlan}}).then((function(n){var e,r,i,a;t((null===n||void 0===n||null===(e=n.data)||void 0===e||null===(r=e.GetCashbackDetailsOfPlanById)||void 0===r||null===(i=r.response)||void 0===i||null===(a=i.meta)||void 0===a?void 0:a.cashback)||null)})).catch((function(n){console.error("Failed to fetch Cashbacks configuration",n)}))}),[e]),e}},MVfC:function(n,e,t){"use strict";t.d(e,"b",(function(){return q})),t.d(e,"o",(function(){return A})),t.d(e,"d",(function(){return k})),t.d(e,"m",(function(){return T})),t.d(e,"f",(function(){return N})),t.d(e,"g",(function(){return R})),t.d(e,"a",(function(){return L})),t.d(e,"p",(function(){return _})),t.d(e,"i",(function(){return U})),t.d(e,"h",(function(){return B})),t.d(e,"c",(function(){return V})),t.d(e,"q",(function(){return E})),t.d(e,"j",(function(){return F})),t.d(e,"n",(function(){return G})),t.d(e,"l",(function(){return w})),t.d(e,"e",(function(){return x})),t.d(e,"k",(function(){return z}));var r=t("jT3O"),i=t("UYTu");function a(){var n=Object(r.a)(["\n  query pharmaPrescriptionOption(\n    $pharmaPrescriptionOptionInput: PharmaPrescriptionOptionInput\n  ) {\n    pharmaPrescriptionOption(\n      pharmaPrescriptionOptionInput: $pharmaPrescriptionOptionInput\n    ) {\n      pharmaPrescriptionOption {\n        id\n        title\n        visible\n        enable\n        message\n        note\n        completionTime\n      }\n    }\n  }\n"]);return a=function(){return n},n}function d(){var n=Object(r.a)(["\n  query getMedicineOrderLiveTat($orderAutoId: Int) {\n    getMedicineOrderLiveTat(orderAutoId: $orderAutoId) {\n      orderTat\n    }\n  }\n"]);return d=function(){return n},n}function s(){var n=Object(r.a)(["\n  query getMedicineOrderCancelReasonsV2(\n    $getMedicineOrderCancelReasonsV2Input: GetMedicineOrderCancelReasonsV2Input\n  ) {\n    getMedicineOrderCancelReasonsV2(\n      getMedicineOrderCancelReasonsV2Input: $getMedicineOrderCancelReasonsV2Input\n    ) {\n      cancellationReasonBuckets {\n        id\n        reasons {\n          isUserReason\n          description\n          sortOrder\n          reasonCode\n          displayMessage\n          config {\n            userCommentRequired\n            commentMinLength\n            commentMaxLength\n          }\n          nudgeConfig {\n            enabled\n            message\n          }\n        }\n        sortOrder\n        bucketName\n      }\n    }\n  }\n"]);return s=function(){return n},n}function c(){var n=Object(r.a)(["\n  query pharmaOrderMessage($orderId: Int) {\n    pharmaOrderMessage(orderId: $orderId) {\n      message\n      title\n    }\n  }\n"]);return c=function(){return n},n}function u(){var n=Object(r.a)(["\n  query PharmacyOrders($patientId: String, $pageNo: Int, $pageSize: Int) {\n    pharmacyOrders(\n      patientId: $patientId\n      pageNo: $pageNo\n      pageSize: $pageSize\n    ) {\n      meta {\n        pageNo\n        pageSize\n        total\n      }\n      pharmaOrders {\n        id\n        bookingSource\n        devliveryCharges\n        estimatedAmount\n        orderAutoId\n        appointmentId\n        currentStatus\n        orderType\n        quoteDateTime\n        orderDateTime\n        medicineOrderPayments {\n          paymentStatus\n          paymentRefId\n          paymentType\n          amountPaid\n          paymentDateTime\n          paymentMode\n        }\n        PaymentOrdersPharma {\n          amountPaid\n          paymentDateTime\n          paymentRefId\n          paymentStatus\n          paymentMode\n          refund {\n            refundAmount\n            txnTimestamp\n            refundStatus\n            refundId\n          }\n        }\n      }\n    }\n  }\n"]);return u=function(){return n},n}function o(){var n=Object(r.a)(["\n  mutation saveMedicineOrderPaymentMqV2(\n    $medicinePaymentMqInput: MedicinePaymentMqV2Input!\n  ) {\n    saveMedicineOrderPaymentMqV2(\n      medicinePaymentMqInput: $medicinePaymentMqInput\n    ) {\n      errorCode\n      errorMessage\n      # paymentOrderId\n      # orderStatus\n    }\n  }\n"]);return o=function(){return n},n}function l(){var n=Object(r.a)(["\n  mutation SaveMedicineOrderPaymentMq(\n    $medicinePaymentMqInput: MedicinePaymentMqInput!\n  ) {\n    SaveMedicineOrderPaymentMq(\n      medicinePaymentMqInput: $medicinePaymentMqInput\n    ) {\n      errorCode\n      errorMessage\n      # orderId\n      # orderAutoId\n    }\n  }\n"]);return l=function(){return n},n}function p(){var n=Object(r.a)(["\n  mutation updateMedicineOrderSubstitution(\n    $transactionId: Int\n    $orderId: Int\n    $substitution: String\n    $paymentOrderId: String\n  ) {\n    updateMedicineOrderSubstitution(\n      transactionId: $transactionId\n      orderId: $orderId\n      substitution: $substitution\n      paymentOrderId: $paymentOrderId\n    ) {\n      message\n    }\n  }\n"]);return p=function(){return n},n}function m(){var n=Object(r.a)(["\n  mutation saveMedicineOrderV2($medicineOrderInput: SaveMedicineOrderV2Input) {\n    saveMedicineOrderV2(medicineOrderInput: $medicineOrderInput) {\n      errorCode\n      errorMessage\n      transactionId\n      isCodEligible\n      codMessage\n      orders {\n        id\n        orderAutoId\n      }\n    }\n  }\n"]);return m=function(){return n},n}function O(){var n=Object(r.a)(["\n  mutation saveMedicineOrderOMS($medicineCartOMSInput: MedicineCartOMSInput) {\n    saveMedicineOrderOMS(medicineCartOMSInput: $medicineCartOMSInput) {\n      errorCode\n      errorMessage\n      orderId\n      orderAutoId\n    }\n  }\n"]);return O=function(){return n},n}function I(){var n=Object(r.a)(["\n  mutation savePrescriptionMedicineOrderOMS(\n    $prescriptionMedicineOMSInput: PrescriptionMedicineOrderOMSInput\n  ) {\n    savePrescriptionMedicineOrderOMS(\n      prescriptionMedicineOMSInput: $prescriptionMedicineOMSInput\n    ) {\n      status\n      orderId\n      orderAutoId\n      errorCode\n      errorMessage\n    }\n  }\n"]);return I=function(){return n},n}function b(){var n=Object(r.a)(["\n  query GetCashbackDetailsOfPlanById($plan_id: String) {\n    GetCashbackDetailsOfPlanById(plan_id: $plan_id) {\n      code\n      success\n      message\n      response\n    }\n  }\n"]);return b=function(){return n},n}function f(){var n=Object(r.a)(["\n  query GetOneApollo($patientId: String) {\n    getOneApolloUser(patientId: $patientId) {\n      availableHC\n      name\n      earnedHC\n      tier\n      burnedCredits\n      blockedCredits\n    }\n  }\n"]);return f=function(){return n},n}function S(){var n=Object(r.a)(["\n  query GetPatientFeedback($patientId: String, $transactionId: String) {\n    getPatientFeedback(patientId: $patientId, transactionId: $transactionId) {\n      feedback {\n        rating\n      }\n    }\n  }\n"]);return S=function(){return n},n}function v(){var n=Object(r.a)(["\n  mutation savePharmacologistConsult(\n    $savePharmacologistConsultInput: SavePharmacologistConsultInput!\n  ) {\n    savePharmacologistConsult(\n      savePharmacologistConsultInput: $savePharmacologistConsultInput\n    ) {\n      status\n    }\n  }\n"]);return v=function(){return n},n}function y(){var n=Object(r.a)(["\n  mutation addPatientFeedback($patientFeedbackInput: PatientFeedbackInput!) {\n    addPatientFeedback(patientFeedbackInput: $patientFeedbackInput) {\n      status\n    }\n  }\n"]);return y=function(){return n},n}function g(){var n=Object(r.a)(["\n  query getMedicineOrdersByTransactionId(\n    $patientId: String\n    $transactionId: Int\n  ) {\n    getMedicineOrdersByTransactionId(\n      patientId: $patientId\n      transactionId: $transactionId\n    ) {\n      medicineOrdersList {\n        id\n        createdDate\n        orderAutoId\n        billNumber\n        shopAddress\n        deliveryType\n        currentStatus\n        orderDateTime\n        medicineOrdersStatus {\n          id\n          statusDate\n          orderStatus\n          hideStatus\n        }\n        medicineOrderLineItems {\n          medicineName\n        }\n        medicineOrderShipments {\n          medicineOrderInvoice {\n            itemDetails\n          }\n        }\n      }\n    }\n  }\n"]);return g=function(){return n},n}function h(){var n=Object(r.a)(["\n  query getMedicineOrderOMSDetailsWithAddress(\n    $patientId: String\n    $orderAutoId: Int\n    $billNumber: String\n  ) {\n    getMedicineOrderOMSDetailsWithAddress(\n      patientId: $patientId\n      orderAutoId: $orderAutoId\n      billNumber: $billNumber\n    ) {\n      tatBreached\n      medicineOrderDetails {\n        id\n        appointmentId\n        totalCashBack\n        createdDate\n        orderAutoId\n        billNumber\n        coupon\n        devliveryCharges\n        prismPrescriptionFileId\n        couponDiscount\n        productDiscount\n        redeemedAmount\n        estimatedAmount\n        prescriptionImageUrl\n        orderTat\n        orderType\n        shopAddress\n        packagingCharges\n        deliveryType\n        currentStatus\n        patientAddressId\n        alertStore\n        meta {\n          reUploadPresc\n        }\n        billedItems {\n          billedDiscountPrice\n          billedMrp\n          billedPrice\n          billedQty\n          itemId\n          itemName\n          orderedDiscountPrice\n          orderedMrp\n          orderedPrice\n          orderedQty\n        }\n        medicineOrderLineItems {\n          medicineSKU\n          medicineName\n          price\n          mrp\n          quantity\n          isMedicine\n          mou\n          isPrescriptionNeeded\n        }\n        medicineOrderPayments {\n          id\n          paymentType\n          amountPaid\n          paymentRefId\n          paymentStatus\n          paymentDateTime\n          responseCode\n          responseMessage\n          bankTxnId\n          healthCreditsRedeemed\n          healthCreditsRedemptionRequest {\n            Success\n            Message\n            RequestNumber\n            AvailablePoints\n            BalancePoints\n            RedeemedPoints\n            PointsValue\n          }\n          paymentMode\n          refundAmount\n          paymentMethod\n        }\n        medicineOrderRefunds {\n          refundAmount\n          refundStatus\n          refundId\n          orderId\n          createdDate\n        }\n        medicineOrdersStatus {\n          id\n          orderStatus\n          statusDate\n          hideStatus\n          statusMessage\n          customReason\n        }\n        medicineOrderShipments {\n          id\n          siteId\n          siteName\n          apOrderNo\n          updatedDate\n          currentStatus\n          itemDetails\n          medicineOrdersStatus {\n            id\n            orderStatus\n            statusDate\n            hideStatus\n          }\n          medicineOrderInvoice {\n            id\n            siteId\n            remarks\n            requestType\n            vendorName\n            billDetails\n            itemDetails\n          }\n        }\n        patient {\n          mobileNumber\n          id\n          firstName\n          lastName\n          addressList {\n            id\n            addressLine1\n            addressLine2\n            city\n            state\n            zipcode\n          }\n        }\n        medicineOrderAddress {\n          addressLine1\n          addressLine2\n          city\n          state\n          zipcode\n          name\n          mobileNumber\n        }\n        consultInfo {\n          doctorName\n          appointmentDateTime\n        }\n        amountBreakUp {\n          totalCashBack\n          circleCashBack\n          couponCashBack\n        }\n        transactionId\n      }\n      orderCancellationAllowedDetails {\n        cancellationAllowed\n        cancellationRequestRaised\n        cancellationRequestRejected\n        message\n      }\n    }\n  }\n"]);return h=function(){return n},n}function M(){var n=Object(r.a)(["\n  query pharmaBoughtTogether($addOnsInput: PharmaBoughtTogetherRequest) {\n    pharmaBoughtTogether(addOnsInput: $addOnsInput) {\n      addOns {\n        sku\n        name\n        price\n        mou\n        image\n        thumbnail\n        small_image\n        is_express\n        is_in_contract\n        is_prescription_required\n        description\n        subcategory\n        type_id\n        url_key\n        is_in_stock\n        MaxOrderQty\n        sell_online\n        manufacturer\n        dc_availability\n        tat\n        tatDuration\n        tatPrice\n        boost_score\n      }\n    }\n  }\n"]);return M=function(){return n},n}function P(){var n=Object(r.a)(["\n  query getMedicineOrdersOMSList(\n    $patientId: String\n    $pageSize: Int\n    $refStartDate: DateTime\n  ) {\n    getMedicineOrdersOMSList(\n      patientId: $patientId\n      pageSize: $pageSize\n      refStartDate: $refStartDate\n    ) {\n      medicineOrdersList {\n        id\n        createdDate\n        orderAutoId\n        billNumber\n        shopAddress\n        deliveryType\n        currentStatus\n        orderDateTime\n        orderTat\n        latestOrderStatus\n        medicineOrdersStatus {\n          id\n          statusDate\n          orderStatus\n          hideStatus\n        }\n        medicineOrderLineItems {\n          medicineName\n        }\n        medicineOrderShipments {\n          medicineOrderInvoice {\n            itemDetails\n          }\n        }\n        quoteDateTime\n      }\n    }\n  }\n"]);return P=function(){return n},n}function C(){var n=Object(r.a)(["\n  query GetMedicineOrderCancelReasons {\n    getMedicineOrderCancelReasons {\n      cancellationReasons {\n        reasonCode\n        description\n        displayMessage\n        isUserReason\n      }\n    }\n  }\n"]);return C=function(){return n},n}function j(){var n=Object(r.a)(["\n  query pharmaPaymentStatusV2($transactionId: Int, $paymentOrderId: String) {\n    pharmaPaymentStatusV2(\n      transactionId: $transactionId\n      paymentOrderId: $paymentOrderId\n    ) {\n      paymentRefId\n      bankTxnId\n      amountPaid\n      paymentStatus\n      paymentDateTime\n      paymentMode\n      isSubstitution\n      substitutionTime\n      substitutionMessage\n      planPurchaseDetails {\n        planPurchased\n        totalCashBack\n        planValidity\n      }\n      paymentMethod\n      prescriptionType\n      patientId\n    }\n  }\n"]);return j=function(){return n},n}function $(){var n=Object(r.a)(["\n  query PharmaPaymentStatus($orderId: Int) {\n    pharmaPaymentStatus(orderId: $orderId) {\n      paymentRefId\n      bankTxnId\n      amountPaid\n      paymentStatus\n      paymentDateTime\n      paymentMode\n      orderDateTime\n      planPurchaseDetails {\n        planPurchased\n        totalCashBack\n        planValidity\n      }\n    }\n  }\n"]);return $=function(){return n},n}function D(){var n=Object(r.a)(["\n  mutation CancelMedicineOrderOMS(\n    $medicineOrderCancelOMSInput: MedicineOrderCancelOMSInput\n  ) {\n    cancelMedicineOrderOMS(\n      medicineOrderCancelOMSInput: $medicineOrderCancelOMSInput\n    ) {\n      orderStatus\n    }\n  }\n"]);return D=function(){return n},n}var q=Object(i.a)(D()),A=(Object(i.a)($()),Object(i.a)(j())),k=(Object(i.a)(C()),Object(i.a)(P())),T=Object(i.a)(M()),N=Object(i.a)(h()),R=Object(i.a)(g()),L=Object(i.a)(y()),_=Object(i.a)(v()),U=Object(i.a)(S()),B=Object(i.a)(f()),V=Object(i.a)(b()),E=(Object(i.a)(I()),Object(i.a)(O()),Object(i.a)(m()),Object(i.a)(p())),F=(Object(i.a)(l()),Object(i.a)(o()),Object(i.a)(u())),G=Object(i.a)(c()),w=Object(i.a)(s()),x=Object(i.a)(d()),z=Object(i.a)(a())}}]);